# Интеграция реальных адресов в систему алертов

## Описание изменений

Реализована интеграция реальных адресов домов из файла `МКД_полигоны.geojson` в систему генерации алертов.

## Что изменилось

### `backend/alert_controller.py`

1. **Добавлена функция `load_house_addresses()`** — загружает адреса домов из GeoJSON файла при импорте модуля
   - Читает файл `backend/data/МКД_полигоны.geojson`
   - Создает словарь `{UNOM: address}` для быстрого доступа
   - Загружено **198 адресов домов**

2. **Обновлена функция `get_house_address(unom: int)`** — теперь использует реальные адреса
   - Возвращает реальный адрес, если UNOM найден в загруженных данных
   - Возвращает `"УНОМ {unom}"` если адрес не найден (вместо старого плейсхолдера)

## Примеры использования

### До изменений:
```
В МКД по адресу ул. Примерная, д.9 отсутствует водоснабжение
```

### После изменений:
```
В МКД по адресу ул. Сталеваров, д.14, корп.4 отсутствует водоснабжение
В МКД по адресу ул. Молостовых, д.11, корп.3 отсутствует водоснабжение (возможно утечка)
На участке трубопровода между ЦТП 04-07-0212/031 и МКД по адресу ул. Молостовых, д.11, корп.5 авария
```

## Структура данных

Файл `backend/data/МКД_полигоны.geojson` содержит:
- **type**: "FeatureCollection"
- **features**: массив объектов с properties:
  - `UNOM` — уникальный номер дома
  - `address` — адрес дома
  - `ctp` — идентификатор ЦТП
  - `floors` — количество этажей
  - `sections` — количество секций
  - `appartments` — количество квартир
  - `live_area` — жилая площадь
  - `osm_id` — идентификатор OpenStreetMap

## Покрытие адресов

- **Всего домов в системе**: 198
- **Адреса загружены**: 100%
- **Типы адресов**:
  - Улица Молостовых
  - Улица Сталеваров
  - Саянская улица
  - Челябинская улица
  - Шоссе Энтузиастов
  - Свободный проспект
  - Магнитогорская улица
  - И другие

## Совместимость

- ✅ Обратная совместимость сохранена
- ✅ API не изменился
- ✅ Если адрес не найден, возвращается УНОМ (graceful degradation)
- ✅ Все существующие алерты автоматически используют новые адреса

## Тестирование

Для проверки загрузки адресов:

```python
from alert_controller import HOUSE_ADDRESSES, get_house_address

# Проверить количество загруженных адресов
print(f"Загружено адресов: {len(HOUSE_ADDRESSES)}")

# Получить адрес по UNOM
address = get_house_address(15109)
print(address)  # "ул. Молостовых, д.11, корп.2"
```

## Зависимости

Не требуется дополнительных зависимостей — используются только стандартные библиотеки Python:
- `json` — для чтения GeoJSON
- `os` — для работы с путями файлов

## Производительность

- Загрузка адресов выполняется **один раз** при импорте модуля
- Доступ к адресу: **O(1)** — через словарь
- Память: ~20-30 КБ для хранения 198 адресов

## Возможные улучшения

1. Добавить кэширование адресов в Redis для распределенных систем
2. Реализовать автоматическое обновление адресов при изменении GeoJSON файла
3. Добавить API endpoint для получения списка всех домов с адресами
4. Интегрировать геокодирование для домов, не найденных в GeoJSON

